TARGET: libmobse.a petar.mobse

MOBSE_PATH=mobse
FC=@FC@
CXX=@CXX@

#FFLAGS = -O2 -Wall -finit-real=nan 
CXXFLAGS = @CXXFLAGS@ @OPTFLAGS@ @OPENMP_CXXFLAGS@
FFLAGS += @FCFLAGS@
#FFLIBS += @FLIBS@
#FFLAGS= -g -O0 -Wall -finit-real=nan -fbounds-check
#CXXFLAGS= -g -O2 -Wall -std=c++11 -fbounds-check

VPATH=$(MOBSE_PATH)

SRC:= $(shell find $(MOBSE_PATH) -type f  \( -iname '*.f' ! -iname '.*' ! -iname 'mo[sb]se.f' ! -iname 'popbin.f' \) )
OBJ:= $(SRC:.f=.o)

libmobse.a: $(OBJ)
	ar rcs $@ $^

petar.mobse: mobse_test.cxx libmobse.a mobse_interface.h
	$(CXX) $(CXXFLAGS) $< -o $@ -L./ -lmobse -lgfortran 

clean:
	rm -f $(MOBSE_PATH)/*.o *.o petar.mobse libmobse.a